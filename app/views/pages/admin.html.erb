<h1>Dashboard</h1>

<h2>Product Listings</h2>

<table class="table table-striped">
  <thead>
    <tr>
      <th>Name</th>
      <th>Brand</th>
      <th>Description</th>
      <th>Price</th>
      <th>Approved</th>
      <th>Image</th>
      <th>User</th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @product_listings.each do |product_listing| %>
      <tr>
        <td><%= product_listing.name %></td>
        <td><%= product_listing.brand %></td>
        <td><%= product_listing.description %></td>
        <td><%= product_listing.price %></td>
        <td><%= product_listing.approved %></td>
        <td><%= cl_image_tag(product_listing.image.key, crop: :scale, width: 100, cloud_name: 'ashlii')%></td>
        <td><%= product_listing.user_id %></td>
        <td><%= link_to 'Show', product_listing %></td>
        <% if current_user.has_role? :admin %>
          <td><%= link_to 'Edit', edit_product_listing_path(product_listing) %></td>
          <td><%= link_to 'Destroy', product_listing, method: :delete, data: { confirm: 'Are you sure?' } %></td>
        <%end%>
      </tr>
    <% end %>
    <%= will_paginate @product_listings %>
  </tbody>
</table>

<h2>Users</h2>
<table class="table table-striped">
    <thead>
      <tr>
        <th>User</th>
        <th>First Name</th>
        <th>Last Name</th>
        <th>Contact Number</th>
        <th>Street Number</th>
        <th>Street Name</th>
        <th>Suburb</th>
        <th>State</th>
        <th>Postcode</th>
        <th>Email</th>
        <th colspan="3"></th>
      </tr>
    </thead>
  
    <tbody>


      <% @user.each do |u| %>
        <tr>
          <td><%= u.user_detail.user_id %></td>
          <td><%= u.user_detail.first_name %></td>
          <td><%= u.user_detail.last_name %></td>
          <td><%= u.user_detail.contact_number %></td>
          <td><%= u.user_detail.address_line_1 %></td>
          <td><%= u.user_detail.address_line_2 %></td>
          <td><%= u.user_detail.suburb %></td>
          <td><%= u.user_detail.state %></td>
          <td><%= u.user_detail.postcode %></td>
          <td><%= u.user_detail.user.email %></td>
          <td><%= link_to 'Edit', user_registration_path, method: :patch %></td>
          <td><%= link_to 'Destroy', '/users', method: :delete, data: { confirm: 'Are you sure?' } %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

<br>
<h2>Sales</h2>
<table class="table table-striped">
    <thead>
      <tr>
        <th>Product</th>
        <th>Buyer ID</th>
        <th>Seller ID</th>
        <th>Amount</th>
       
        <th colspan="3"></th>
      </tr>
    </thead>
  
    <tbody>
      <% @orders.each do |order| %>
      <tr>
        <td><%= order.product_listing_id %></td>
        <td><%= order.user_id %></td>
        <td><%= order.seller_email%></td>
        <td><%= order.amount %></td>
      </tr>
    <% end %>


    </tbody>
  </table>


<%= link_to 'Back to Wardrobe', product_listings_path %>
